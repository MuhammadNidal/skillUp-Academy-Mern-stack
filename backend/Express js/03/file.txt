ğŸ§  Step 1 â€” Install MongoDB Locally

If you havenâ€™t installed it yet:

ğŸ‘‰ Download: https://www.mongodb.com/try/download/community

Install MongoDB Community Server, then make sure the MongoDB service is running.

âœ… To check if MongoDB is running:

Open your terminal or PowerShell and type:

mongosh


If it opens the MongoDB shell with something like this:

test> 


then MongoDB is working locally ğŸ‰

If not, you can start it manually:

Windows: Open â€œServicesâ€ â†’ find MongoDB Server â†’ Start

macOS/Linux: Run

sudo systemctl start mongod

âš™ï¸ Step 2 â€” Create an Express Project
mkdir express-local-mongo
cd express-local-mongo
npm init -y
npm install express mongoose dotenv


Project structure:

express-local-mongo/
â”‚
â”œâ”€â”€ server.js
â”œâ”€â”€ .env
â”œâ”€â”€ models/
â”‚   â””â”€â”€ User.js
â””â”€â”€ routes/
    â””â”€â”€ userRoutes.js

ğŸ“„ Step 3 â€” .env File (Local MongoDB URI)

Your .env file should look like this:

MONGO_URI=mongodb://127.0.0.1:27017/mydatabase
PORT=5000


ğŸ”¹ 127.0.0.1 = localhost
ğŸ”¹ 27017 = default MongoDB port
ğŸ”¹ mydatabase = your database name (MongoDB will auto-create it)

ğŸš€ Step 4 â€” Connect to MongoDB (server.js)
// server.js
import express from "express";
import mongoose from "mongoose";
import dotenv from "dotenv";
import userRoutes from "./routes/userRoutes.js";

dotenv.config();

const app = express();
app.use(express.json());

// MongoDB Local Connection
mongoose.connect(process.env.MONGO_URI)
  .then(() => console.log("âœ… Connected to Local MongoDB"))
  .catch((err) => console.log("âŒ Database Connection Error:", err));

// Test route
app.get("/", (req, res) => {
  res.send("Local MongoDB connected successfully!");
});

// User routes
app.use("/api/users", userRoutes);

const PORT = process.env.PORT || 5000;
app.listen(PORT, () => console.log(`ğŸš€ Server running on port ${PORT}`));

ğŸ§© Step 5 â€” Mongoose Model (models/User.js)
import mongoose from "mongoose";

const userSchema = new mongoose.Schema({
  name: { type: String, required: true },
  email: { type: String, unique: true, required: true },
  age: { type: Number, default: 18 },
}, { timestamps: true });

export default mongoose.model("User", userSchema);

ğŸ”„ Step 6 â€” Routes (routes/userRoutes.js)
import express from "express";
import User from "../models/User.js";

const router = express.Router();

// CREATE user
router.post("/", async (req, res) => {
  try {
    const user = await User.create(req.body);
    res.status(201).json(user);
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});

// READ all users
router.get("/", async (req, res) => {
  try {
    const users = await User.find();
    res.json(users);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});

// READ one user
router.get("/:id", async (req, res) => {
  try {
    const user = await User.findById(req.params.id);
    if (!user) return res.status(404).json({ message: "User not found" });
    res.json(user);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});

// UPDATE user
router.put("/:id", async (req, res) => {
  try {
    const updatedUser = await User.findByIdAndUpdate(req.params.id, req.body, { new: true });
    res.json(updatedUser);
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});

// DELETE user
router.delete("/:id", async (req, res) => {
  try {
    await User.findByIdAndDelete(req.params.id);
    res.json({ message: "User deleted" });
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});

export default router;

â–¶ï¸ Step 7 â€” Run the Server

Start the app:

node server.js


Output should be:

âœ… Connected to Local MongoDB
ğŸš€ Server running on port 5000

ğŸ§ª Step 8 â€” Test with Postman or Thunder Client
Method	URL	Body Example	Description
POST	http://localhost:5000/api/users	{ "name": "Nidal", "email": "nidal@example.com", "age": 22 }	Create a user
GET	http://localhost:5000/api/users	â€”	Get all users
GET	http://localhost:5000/api/users/:id	â€”	Get one user
PUT	http://localhost:5000/api/users/:id	{ "age": 25 }	Update user
DELETE	http://localhost:5000/api/users/:id	â€”	Delete user
ğŸ—ƒï¸ Step 9 â€” Verify in MongoDB Shell

In mongosh:

use mydatabase
db.users.find().pretty()


Youâ€™ll see your data directly from MongoDB.

âœ… Final Notes

âœ… Local MongoDB connection string:

mongodb://127.0.0.1:27017/<your_database_name>


âœ… Make sure MongoDB service is running before starting your Express server.

âœ… Mongoose auto-creates the database and collections when you insert the first document.






router.put('/users/:id', async (req, res) => {
    try {
        const updatedUser = await User.findByIdAndUpdate(
                           req.params.id,          // Find user by ID
            req.body,// Update data from request body
            { new: true, runValidators: true } // Return updated doc & run schema validators
        );
        if (!updatedUser) return res.status(404).json({ error: 'User not found' });
        res.status(200).json(updatedUser);
    } catch (error) {
        console.error('Error updating user:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// --------------------
// DELETE a user by ID
// --------------------
router.delete('/users/:id', async (req, res) => {
    try {
        const deletedUser = await User.findByIdAndDelete(req.params.id);
        if (!deletedUser) return res.status(404).json({ error: 'User not found' });
        res.status(200).json({ message: 'User deleted successfully' });
    } catch (error) {
        console.error('Error deleting user:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

module.exports = router;
ğŸ§  Explanation of New Parts
ğŸ”¹ Update Route (PUT /users/:id)
findByIdAndUpdate(id, data, options) updates a document by its ID.

{ new: true } â†’ returns the updated version (not the old one).

{ runValidators: true } â†’ ensures schema validation still applies.

Responds with 404 if the user doesnâ€™t exist.

Example test (with curl or Postman):

bash
Copy code
PUT /users/670fe541e6f3b3f7d12e8a91
{
  "name": "Updated Name",
  "email": "updated@example.com"
}
ğŸ”¹ Delete Route (DELETE /users/:id)
findByIdAndDelete(id) removes the document.

Responds with a success message or 404 if user doesnâ€™t exist.

Example test:

bash
Copy code
DELETE /users/670fe541e6f3b3f7d12e8a91
Response:

json
Copy code
{
  "message": "User deleted successfully"
}
